
@{
    ViewBag.Title = "PlacementReceive";
    Layout = "~/Views/Shared/_CollegeLayout.cshtml";
}


@using TechPlacement.Model;
@model  IEnumerable<PlacementDetails>
    <div class="body flex-grow-1" style="padding-left:0px !important;">
        <div class="container-lg px-0">
            <form class="form-control">
                <div class="row">

                    <div class="col-12">
                             <div class="row">
                            <div id="displayMsg" class="col-12" style="color:green">
                            </div>

                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-12" style="overflow: auto; ">
                                    <table id="example" class="table table-striped table-bordered" style="width:100%">
                                        <thead>
                                            <tr>
                                                <th>JobCategory</th>
                                                <th>Min_CGPA</th>
                                                <th>NumberOfPositions</th>
                                                <th>InterviewDate</th>


                                            </tr>

                                        </thead>
                                        <tbody>
                                            @{
                                                foreach (var PlacementDetails in Model)
                                                {

                                                    <tr>
                                                        <td> @PlacementDetails.JobCategory</td>
                                                        <td>@PlacementDetails.Min_CGPA</td>
                                                        <td> @PlacementDetails.NumberOfPositions</td>
                                                        <td> @PlacementDetails.InterviewDate</td>


                                                    </tr>


                                                }

                                            }
                                        </tbody>
                                    </table>

                                </div>

                            </div>

                        </div>
                    </div>
                    <div class="col-12">

                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="modal hide fade in" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="lblexampleModalLabel"> Add Student </h5>
                    <button type="button" class="close btnCloseModal" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="div1"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" id="btnsubmit" class="btn btn-primary">Save </button>
                    <button type="button" class="btn btn-secondary btnCloseModal" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
        <input id="userMode" type="hidden" />
    </div>

    <script>
        $(document).ready(function () {
            $('#example').DataTable();

            $('#exampleModal').modal({
                backdrop: 'static',
                keyboard: false
            });

        });

        $(".btnStudentEdit").click(function () {
            var id = $(this).attr('id');
            $("#userMode").val("Edit");
            $.ajax({
                url: "/Dashboard/GetStudentById",
                data: { studentId: id },
                success: function (result) {
                    $("#div1").html(result);
                    $('#exampleModal').modal('show');
                }
            });


        });


        $(".btnStudentDelete").click(function () {
            debugger;
            var id = $(this).attr('id');
            $.ajax({
                url: "/Dashboard/DeleteStudent",
                type: "POST",
                dataType: 'json',
                contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
                data: { studentId: id },
                success: function (result) {

                    var output = result;
                    if (result.success == true) {
                        debugger;
                        var resultOut = result.message;
                        $("#displayMsg").html(resultOut);
                        //  reload();
                    }
                    else {
                        alert(result.message);
                    }
                }
            });

        });

        $("#btnAddStudent").click(function () {
            debugger;
            var id = -1;

            $("#userMode").val("Add");
            $.ajax({
                url: "/Dashboard/GetStudentById",
                data: { studentId: id },
                success: function (result) {
                    $("#div1").html(result);
                    $('#exampleModal').modal('show');
                }
            });
        });

        $(".btnCloseModal").click(function () {
            $('#exampleModal').modal('hide');
        })




        $("#btnsubmit").click(function (e) {
            // Validate Password and Confirm Password
            debugger;
            var firstName = $("#FName").val();
            var lastName = $("#LName").val();

            var errorMsg = "";

            if (firstName == "") {
                errorMsg = errorMsg + ' ' + "Enter Valid First Name. Special characters not allowed ! <br/>";
            }

            if (lastName == "") {
                errorMsg = errorMsg + ' ' + "Enter Valid Last name. Special characters not allowed ! <br/>";
            }


            //var email = $("#EmailId").val();

            //var expr = /^([\w-\.]+)@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
            //if (!expr.test(email)) {
            //    errorMsg = errorMsg + ' ' + "Invalid e-mail address <br/>";
            //}

            if (errorMsg.length > 0) {
                var objDisplay = $("#diplayMsg").html(errorMsg);
                return;
            }



            //Serialize the form datas.
            var valdata = $("#frmStudentMaster").serialize();
            //to get alert popup
            $.ajax({
                url: "/Dashboard/AddStudentInformation",
                type: "POST",
                dataType: 'json',
                contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
                data: valdata,
                success: function (result) {

                    var output = result;
                    if (result.success == true) {
                        debugger;
                        var resultOut = $("#displayPopupMsg").html(result.message);
                        $("#displayMsg").html(resultOut);
                        $('#exampleModal').modal('hide');
                        //    reload();
                    }
                    else {
                        alert(result.message);
                    }
                }
            });
        });



        function reload() {
            location.reload();
        };



    </script>

